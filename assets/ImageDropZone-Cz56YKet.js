import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{R as F}from"./iframe-Dpetp53f.js";import{g as D}from"./classnames-helper-C6tUBjOJ.js";import{v}from"./validation-helper-Dk7fbBIA.js";import{I as y}from"./Icon-BKr1LsCA.js";import{I as T}from"./InputError-CbmaiM0A.js";import{S as N}from"./ScrollBar-V8uTD4Wh.js";const S=["image/jpeg","image/jpg","image/png"],z=s=>S.includes(s.type),R=s=>new Promise((o,l)=>{const i=new FileReader;i.onloadend=()=>o(i.result),i.onerror=l,i.readAsDataURL(s)}),L=(s,o,l,i="image/jpeg",c=100,e=0)=>{const g=c/100,r=document.createElement("canvas"),m=r.getContext("2d");return e===90||e===270?(r.width=l,r.height=o):(r.width=o,r.height=l),m&&(m.save(),e!==0&&(m.translate(r.width/2,r.height/2),m.rotate(e*Math.PI/180),m.translate(-r.width/2,-r.height/2)),m.drawImage(s,0,0,o,l),m.restore()),r.toDataURL(i,g)},x=s=>{const l=atob(s.replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),i=[];for(let c=0;c<l.length;c+=512){const e=l.slice(c,c+512),g=new Array(e.length);for(let r=0;r<e.length;r++)g[r]=e.charCodeAt(r);i.push(new Uint8Array(g))}return i},P=(s,o)=>{const l=x(s);return new Blob(l,{type:o})},C=(s,o,l)=>{const i=x(s);return new File(i,o,{type:l})},E=(s,o,l,i,c=100,e=0,g="image/jpeg",r="file")=>{if(!z(s))throw new Error("File is not a supported image type.");const m=new FileReader;m.onload=()=>{const d=new Image;d.onload=()=>{const p=L(d,o,l,g,c,e);switch(r){case"blob":i(P(p,g));break;case"file":i(C(p,s.name,g));break;case"base64":default:i(p);break}},d.src=m.result},m.onerror=()=>{throw new Error("Failed to read the image file.")},m.readAsDataURL(s)},V=({className:s,maxImages:o=13,imageWidth:l=1024,imageHeight:i=576,accept:c="image/jpeg, image/png",field:e,onChange:g})=>{const r=F.useRef(null),m=D({"image-drop-zone":!0,[s||""]:!!s}),d=()=>{var a;return(a=r.current)==null?void 0:a.click()},p=a=>{const n=Array.isArray(e.value)?e.value:[];v({...e,value:[...n,...a]},g)},f=async a=>{const n=[];for(const u of a){const b=await new Promise(I=>{E(u,l,i,A=>I(A),100,0,"image/jpeg","file")}),q=await R(b);n.push(q)}p(n)},w=a=>{a.preventDefault(),a.dataTransfer.files&&f(Array.from(a.dataTransfer.files))},j=a=>{a.target.files&&f(Array.from(a.target.files))},k=(a,n)=>{const u=[...e.value];[u[a],u[n]]=[u[n],u[a]],v({...e,value:u},g)},h=a=>{const n=[...e.value];n.splice(a,1),v({...e,value:n},g)};return t.jsxs("div",{className:m,onDrop:w,onDragOver:a=>a.preventDefault(),children:[t.jsxs("div",{className:"drop-zone",onClick:d,children:[t.jsx(y,{name:"images",size:30,className:"text-secondary"}),t.jsxs("div",{className:"drop-text",children:[t.jsx("strong",{className:"text-primary",style:{cursor:"pointer"},children:"Choose or drop images"}),t.jsx("input",{ref:r,type:"file",accept:c,onChange:j,multiple:!0,hidden:!0})]})]}),t.jsxs("div",{className:"images-loaded",children:[Array.isArray(e.value)&&e.value.length>0&&t.jsxs("div",{className:"main-image draggable-box",draggable:!0,"data-box-number":0,children:[t.jsx(y,{className:"close-icon",name:"x",size:20,onClick:()=>h(0)}),t.jsx("img",{src:e.value[0],alt:"preview-main"})]}),t.jsx(N,{variant:"grey",height:"174px",axis:"vertical",children:t.jsx("div",{className:"small-images-container",children:Array.from({length:o-1},(a,n)=>t.jsx("div",{className:"image-container draggable-box",draggable:!0,"data-box-number":n+1,onDragStart:u=>u.dataTransfer.setData("dragFrom",String(n+1)),onDrop:u=>{const b=parseInt(u.dataTransfer.getData("dragFrom"),10);k(b,n+1)},onDragOver:u=>u.preventDefault(),children:e.value[n+1]?t.jsxs(t.Fragment,{children:[t.jsx(y,{className:"close-icon",name:"x",size:20,onClick:()=>h(n+1)}),t.jsx("img",{src:e.value[n+1],alt:`preview-${n+1}`})]}):null},n))})})]}),e.error&&t.jsx(T,{error:e.error})]})};V.__docgenInfo={description:"",methods:[],displayName:"ImageDropZone",props:{className:{required:!1,tsType:{name:"string"},description:""},maxImages:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"13",computed:!1}},imageWidth:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1024",computed:!1}},imageHeight:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"576",computed:!1}},accept:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"image/jpeg, image/png"',computed:!1}},field:{required:!0,tsType:{name:"intersection",raw:"FormFieldProps & { value: string[] }",elements:[{name:"signature",type:"object",raw:`{
  value: FormFieldValueProps;
  name: string;
  formName: string;
  error: string;
  section: number;
  validate: ValidateProps;
}`,signature:{properties:[{key:"value",value:{name:"union",raw:`| string
| number
| boolean
| File
| File[]
| null
| Array<string>`,elements:[{name:"string"},{name:"number"},{name:"boolean"},{name:"File"},{name:"Array",elements:[{name:"File"}],raw:"File[]"},{name:"null"},{name:"Array",elements:[{name:"string"}],raw:"Array<string>"}],required:!0}},{key:"name",value:{name:"string",required:!0}},{key:"formName",value:{name:"string",required:!0}},{key:"error",value:{name:"string",required:!0}},{key:"section",value:{name:"number",required:!0}},{key:"validate",value:{name:"signature",type:"object",raw:`{
  noValidate?: boolean;
  required?: boolean;
  minStrLength?: number;
  maxStrLength?: number;
  type?: "number" | "text" | "email" | "password";
  minImages?: number;
  maxImages?: number;
  isImagesList?: boolean;
  fileSize?: number;
  dateTimePicker?: boolean;
  dateTimeRangePicker?: boolean;
  email?: boolean;
  phone?: boolean;
  integer?: boolean;
  isYoutubeUrl?: boolean;
}`,signature:{properties:[{key:"noValidate",value:{name:"boolean",required:!1}},{key:"required",value:{name:"boolean",required:!1}},{key:"minStrLength",value:{name:"number",required:!1}},{key:"maxStrLength",value:{name:"number",required:!1}},{key:"type",value:{name:"union",raw:'"number" | "text" | "email" | "password"',elements:[{name:"literal",value:'"number"'},{name:"literal",value:'"text"'},{name:"literal",value:'"email"'},{name:"literal",value:'"password"'}],required:!1}},{key:"minImages",value:{name:"number",required:!1}},{key:"maxImages",value:{name:"number",required:!1}},{key:"isImagesList",value:{name:"boolean",required:!1}},{key:"fileSize",value:{name:"number",required:!1}},{key:"dateTimePicker",value:{name:"boolean",required:!1}},{key:"dateTimeRangePicker",value:{name:"boolean",required:!1}},{key:"email",value:{name:"boolean",required:!1}},{key:"phone",value:{name:"boolean",required:!1}},{key:"integer",value:{name:"boolean",required:!1}},{key:"isYoutubeUrl",value:{name:"boolean",required:!1}}]},required:!0}}]}},{name:"signature",type:"object",raw:"{ value: string[] }",signature:{properties:[{key:"value",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}}]}}]},description:""}}};export{V as I};
